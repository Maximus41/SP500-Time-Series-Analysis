---
title: "Dow Jones Index Time Series Analysis"
output: html_notebook
---

Installing Important Packages

```{r}
install.packages("dplyr")
install.packages("ggplot2")
install.packages("ggfortify")
install.packages("zoo")
install.packages("TSstudio")
install.packages("forecast")
```

Importing the packages

```{r}
library(dplyr)
library(ggplot2)
library(ggfortify)
library(TSstudio)
library(forecast)
```

Importing Dow Jones Dataset

```{r}
index <- read.csv("./data/sp500_index.csv")
index
```

Checking the datatypes of all columns

```{r}
print(sapply(index, class))
```

Transforming the "Date" column from charater to Date

```{r}
transformed_index <- transform(index, Date = as.Date(Date))
```

Checking the Datatypes after transformation

```{r}
print(sapply(transformed_index, class))

```

Formatting the "Date" column to Year-month format inorder to group the index values

```{r}
transformed_index$Month_yr <- format(as.Date(transformed_index$Date), "%Y-%m")
```

```{r}
print(sapply(transformed_index, class))
```

```{r}
transformed_index
```

Averaging the index values for each month and creating a new DataFrame.

```{r}
avg_index <- transformed_index %>% group_by(Month_yr) %>% summarise(average_value = mean(S.P500))
```

```{r}
avg_index
```

Extracting the index values into a new list.

```{r}
index_values <- avg_index[[2]]
```

Plotting the index values

```{r}
plot(index_values)
```

Creating a Time Series Object from the index values.

```{r}
ts_index <- ts(index_values, start=c(2012, 12), end = c(2022, 12), frequency=12)
```

```{r}
ts_index
```

Plotting the Time Series Object.

```{r}
plot(ts_index)
```

```{r}
autoplot(ts_index)
```

```{r}
ts_info(ts_index)
```
Subsetting the ts object with window function
```{r}
ts_index.subset <- window(ts_index, start=c(2017, 5), end=c(2020, 6))
ts_index.subset
autoplot(ts_index.subset)
```
```{r}
#moving average function
plot(ts_index, main="Raw Time Series")
ma(ts_index,order=3)
plot(ma(ts_index,order=3))
ma(ts_index,order=5)
plot(ma(ts_index,5))
```

```{r}
autoplot(ts_index)+
  autolayer(ma(ts_index,3))+
  autolayer(ma(ts_index,5))+
  autolayer(ma(ts_index,7))
```
```{r}
ggtsdisplay(ts_index)
```
Seasonal Decomposition of the Time Series
```{r}
plot(ts_index)
monthplot(ts_index) 
seasonplot(ts_index)

```

Seasonal Decomposition using Multiplicative approach
```{r}
fit.decmult<-decompose(ts_index,type = "multiplicative")
fit.decmult
plot(fit.decmult)
```

Seasonal Decomposition using Additive Approach
```{r}
fit.decadd<-decompose(ts_index, type = "additive")
fit.decadd
plot(fit.decadd)
```

Seasonal Decomposition using STL
```{r}
lts_index <- log(ts_index)
plot(lts_index, ylab="log(ts_index)")
fit.stl <- stl(lts_index, s.window="period")           
plot(fit.stl)
fit.stl$time.series                                 
exp(fit.stl$time.series)
```
